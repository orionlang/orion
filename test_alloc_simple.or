import std.alloc

fn main() I32 {
  unsafe {
    // Test 1: PageAllocator
    var page_alloc: PageAllocator = page_allocator_create()
    var ptr1: ptr = page_alloc.alloc(1)  // Allocate 1 page
    page_alloc.free(ptr1, 1)  // Free 1 page

    // Test 2: GeneralPurposeAllocator
    var page_alloc_for_gpa: PageAllocator = page_allocator_create()
    let gpa1: GeneralPurposeAllocator = gpa_create(page_alloc_for_gpa)
    var gpa_result1: (ptr, GeneralPurposeAllocator) = gpa1.alloc(128)
    var ptr2: ptr = gpa_result1.0
    let gpa2: GeneralPurposeAllocator = gpa_result1.1

    let gpa3: GeneralPurposeAllocator = gpa2.free(ptr2)

    // Test 3: Arena allocator
    var page_alloc2: PageAllocator = page_allocator_create()
    let arena1: Arena = arena_create(page_alloc2)

    var alloc_result1: (ptr, Arena) = arena1.alloc(32)
    let arena2: Arena = alloc_result1.1

    var alloc_result2: (ptr, Arena) = arena2.alloc(32)
    let arena3: Arena = alloc_result2.1

    let arena4: Arena = arena_reset(arena3)
    arena_destroy(arena4)

    return 0
  }
}
